$((function(){nivi.init();var head=document.getElementsByTagName("head")[0],link=document.createElement("link");link.rel="stylesheet",link.type="text/css",link.href="https://mapny.ru/nivi/nivi.css?v=5",link.media="all",head.appendChild(link)}));var nivi={slideDownOnInit:!0,init:function(){var sizeSelector;function initBar(){nivi.appendBar(),nivi.bindControls(),null!=$.cookie("nivi_size")&&$(".nivi-bar li."+$.cookie("nivi_size")).click(),null!=$.cookie("nivi_spacing")&&$(".nivi-bar li."+$.cookie("nivi_spacing")).click(),null!=$.cookie("nivi_font")&&$(".nivi-bar li."+$.cookie("nivi_font")).click(),null!=$.cookie("nivi_color")&&$(".nivi-bar li."+$.cookie("nivi_color")).click(),null!=$.cookie("nivi_image_disable")&&$(".nivi-image-switcher").click(),null!=$.cookie("nivi_image_bw")&&$(".nivi-image-switcher").click()}$(".nivi-toggle").click(initBar),null!=$.cookie("nivi_view")&&(nivi.slideDownOnInit=!1,initBar())},bindControls:function(){var html=$("html"),bar=$(".nivi-bar");bar.find(".nivi-size-section li").each((function(){$(this).click((function(){bar.find(".nivi-size-section li.active").removeClass("active"),$.cookie("nivi_size",$(this).attr("class"),{expires:90,path:"/"}),$(this).addClass("active"),html.removeClass("nivi-normal nivi-medium nivi-large"),html.addClass($(this).attr("data-classname")),window.dispatchEvent(new Event("resize"))}))})),bar.find(".nivi-spacing-section li").each((function(){$(this).click((function(){bar.find(".nivi-spacing-section li.active").removeClass("active"),$.cookie("nivi_spacing",$(this).attr("class"),{expires:90,path:"/"}),$(this).addClass("active"),html.removeClass("nivi-spacing-normal nivi-spacing-medium nivi-spacing-large"),html.addClass($(this).attr("data-classname")),window.dispatchEvent(new Event("resize"))}))})),bar.find(".font-select li").each((function(){$(this).click((function(){bar.find(".font-select li.active").removeClass("active"),$.cookie("nivi_font",$(this).attr("class"),{expires:90,path:"/"}),$(this).addClass("active"),html.removeClass("nivi-font-times nivi-font-montserrat"),html.addClass($(this).attr("data-classname")),window.dispatchEvent(new Event("resize"))}))})),bar.find(".nivi-color-section li").each((function(){$(this).click((function(){bar.find(".nivi-color-section li.active").removeClass("active"),$.cookie("nivi_color",$(this).attr("class"),{expires:90,path:"/"}),$(this).addClass("active"),html.removeClass("nivi-achromatic nivi-invert nivi-blue nivi-yellow nivi-brown"),html.addClass($(this).attr("data-classname"))}))})),bar.find(".nivi-image-switcher").click((function(){$(this).hasClass("active")?($(this).removeClass("active").html(""),$.cookie("nivi_image_disable","off",{path:"/",expires:-5}),html.removeClass("nivi-no-image")):($(this).addClass("active").html(""),$.cookie("nivi_image_disable","on",{path:"/",expires:30}),html.addClass("nivi-no-image")),window.dispatchEvent(new Event("resize"))})),bar.find(".nivi-image-bw").click((function(){$(this).hasClass("active")?($(this).removeClass("active").html(""),$.cookie("nivi_image_disable","off",{path:"/",expires:-5}),html.removeClass("nivi-no-image")):($(this).addClass("active").html(""),$.cookie("nivi_image_disable","on",{path:"/",expires:30}),html.addClass("nivi-no-image")),window.dispatchEvent(new Event("resize"))})),$(".nivi-hide").off("click").click((function(){html.toggleClass("nivi-mini")}))},appendBar:function(){if(1!=$(".nivi-bar").length){var html='<div class="nivi-bar"><div class="nivi-empty"></div><fieldset class="nivi-size-section"><legend>Размер</legend><div class="nivi-size" data-classname="nivi-normal" data-title="Нормальный"></div><ul><li class="nivi-size-normal active" data-classname="nivi-normal" data-title="Изменить размер"></li><li class="nivi-size-medium" data-classname="nivi-medium" data-title="Увеличенный"></li><li class="nivi-size-large" data-classname="nivi-large" data-title="Большой"></li></ul></fieldset><fieldset class="nivi-spacing-section"><legend>Интервал</legend><div class="nivi-spacing" data-classname="nivi-spacing-normal" data-title="Межбуквенный интервал"></div><ul><li class="nivi-spacing-normal active" data-classname="nivi-spacing-normal" data-title="Интервал x1.5"></li><li class="nivi-spacing-medium" data-classname="nivi-spacing-medium" data-title="Интервал x2.5"></li><li class="nivi-spacing-large" data-classname="nivi-spacing-large" data-title="Интервал x3.5"></li></ul></fieldset><fieldset class="nivi-color-section"><legend>Цвет</legend><ul><li class="nivi-color-normal active" data-classname="nivi-achromatic" data-title="Ахроматический">А</li><li class="nivi-color-invert" data-classname="nivi-invert" data-title="Ахроматическая инверсия">А</li><li class="nivi-color-blue" data-classname="nivi-blue" data-title="Хроматический синий">А</li><li class="nivi-color-yellow" data-classname="nivi-yellow" data-title="Светлый">А</li><li class="nivi-color-brown" data-classname="nivi-brown" data-title="Тёмный">А</li></ul></fieldset><fieldset class="nivi-image-section"><legend>Изображения</legend><ul><li class="nivi-image-switcher" data-title="Отключить изображения"></li><li class="nivi-image-bw" data-title="Чёрно-белые изображения"></li></ul></fieldset><fieldset class="nivi-speech-section"><legend>Озвучка</legend><ul><li id="playsound" class="nivi-speech-play" data-title="Воспроизвести"></li><li class="nivi-speech-speed" data-title="Скорость">2x</li><li id="speech-control_replay" class="nivi-speech-replay" data-title="Повторить"></li></ul></fieldset><ul class="nivi-control"><li class="nivi-close"></li><li class="nivi-hide"></li></ul></div><ul class="nivi-settings"><li class="nivi-compact"><input type="checkbox" id="nivi-compact" name="nivi-compact" value="nivi-compact"><label for="nivi-compact">Компактный</label></li><li class="nivi-style-default"><input type="radio" id="nivi-style-default" name="nivi-style" value="nivi-style-default" checked=""><label for="nivi-style-default">Скруглённый</label></li><li class="nivi-style-circle"><input type="radio" id="nivi-style-circle" name="nivi-style" value="nivi-style-circle"><label for="nivi-style-circle">Круглый</label></li><li class="nivi-style-square"><input type="radio" id="nivi-style-square" name="nivi-style" value="nivi-style-square"><label for="nivi-style-square">Квадратный</label></li><li class="nivi-position-top"><input type="radio" id="nivi-position-top" name="nivi-position" value="nivi-position-top" checked=""><label for="nivi-position-top">Сверху</label></li><li class="nivi-position-right"><input type="radio" id="nivi-position-right" name="nivi-position" value="nivi-position-right"><label for="nivi-position-right">Справа</label></li><li class="nivi-position-left"><input type="radio" id="nivi-position-left" name="nivi-position" value="nivi-position-left"><label for="nivi-position-left">Слева</label></li></ul>';$("body").prepend(html),$(".nivi-speech-play").on("click",(function(){$(this).toggleClass("active"),$("p, h1, h2, h3, h4, h5").before("<button class='nivi-speak'></button>"),setTimeout((function(){$(".nivi-speak").each((function(index,value){$(this).attr("id","nivi-speak-item-"+index)}))}),500),setTimeout((function(){$("#nivi-speak-item-1").trigger("click")}),1e3)})),nivi.slideDownOnInit&&$(".nivi-bar").hide().slideDown(),$("html").addClass("nivi-view nivi-normal nivi-achromatic"),$(".nivi-toggle").off("click").click((function(){nivi.switchToNormal()})),$(".nivi-close").off("click").click((function(){nivi.switchToNormal()})),$.cookie("nivi_view","on",{expires:90,path:"/"}),$(window).resize(),$(".nivi-settings li").click((function(){$("html").removeClass("nivi-style-default nivi-style-circle nivi-style-square"),$("#nivi-style-default").is(":checked")?$("html").addClass("nivi-style-default"):$("#nivi-style-circle").is(":checked")?$("html").addClass("nivi-style-circle"):$("#nivi-style-square").is(":checked")&&$("html").addClass("nivi-style-square"),$("html").removeClass("nivi-position-top nivi-position-right nivi-position-left"),$("#nivi-position-top").is(":checked")?$("html").addClass("nivi-position-top"):$("#nivi-position-right").is(":checked")?$("html").addClass("nivi-position-right"):$("#nivi-position-left").is(":checked")&&$("html").addClass("nivi-position-left"),$("html").removeClass("nivi-compact"),$("#nivi-compact").is(":checked")?$("html").addClass("nivi-compact"):$("html").removeClass("nivi-compact")}))}},switchToNormal:function(){$(".nivi-bar").slideUp((function(){$(this).remove(),$.cookie("nivi_view","off",{expires:-1,path:"/"}),window.location.reload()}))},isActive:function(){return $("html").hasClass("nivi-view")}};let voices=speechSynthesis.getVoices(),defaultVoice;speechSynthesis.onvoiceschanged=()=>{voices=speechSynthesis.getVoices(),defaultVoice=voices.find(voice=>"Google русский"===voice.name),wrni.addEventListener("click",handleClick),window.addEventListener("keydown",handleKeydown)};const PLAY="nivi-speak",PAUSE="nivi-speak pause",RESUME="nivi-speak resume";function handleClick({target:target}){switch(target.className){case PLAY:speechSynthesis.cancel();const{textContent:textContent}=target.nextElementSibling;textContent.split(".").forEach(text=>{const trimmed=text.trim();if(trimmed){const U=getUtterance(target,text);speechSynthesis.speak(U)}});break;case PAUSE:target.className=RESUME,speechSynthesis.pause();break;case RESUME:target.className=PAUSE,speechSynthesis.resume()}}function handleKeydown({code:code}){switch(code){case"Escape":return speechSynthesis.cancel()}}function getUtterance(target,text){const U=new SpeechSynthesisUtterance(text);return U.voice=defaultVoice,U.lang=defaultVoice.lang,U.volume=1,U.rate=1,U.pitch=1,U.onstart=()=>{console.log("Started"),target.className=PAUSE},U.onend=()=>{console.log("Finished"),target.className=nivi-speak},U.onerror=err=>console.error(err),U}